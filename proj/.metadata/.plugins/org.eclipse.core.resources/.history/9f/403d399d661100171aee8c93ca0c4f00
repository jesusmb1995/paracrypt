#include "GPUCipherDevice.hpp"

template<typename S>
int paracrypt::GPUCipherDevice<S>::getGridSize(int n_blocks, int threadsPerCipherBlock) {
    int gridSize = n_blocks * threadsPerCipherBlock / this->getThreadsPerThreadBlock();
    return gridSize;
}

template<typename S>
int paracrypt::GPUCipherDevice<S>::addStream() {
	boost::unique_lock< boost::shared_mutex > lock(this->streams_access);
	int id = this->streams.size();
	this->streams[id] = newStream();
	return n;
}

template<typename S>
void paracrypt::GPUCipherDevice<S>::delStream(int stream_id) {
	boost::unique_lock< boost::shared_mutex > lock(this->streams_access);
	this->streams.erase(stream_id);
}

template<typename S>
S paracrypt::GPUCipherDevice<S>::acessStream(int stream_id) {
	boost::shared_lock < boost::shared_mutex > lock(this->streams_access);
	return this->streams[stream_id];
}
